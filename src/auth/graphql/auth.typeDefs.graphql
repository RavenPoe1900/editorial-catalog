"""
Tokens returned by authentication flows.
Includes the user object for convenience.
"""
type AuthTokens {
  accessToken: String!
  refreshToken: String!
  """
  The user associated with the tokens.
  """
  user: User!
}

"""
Input for user login.
"""
input AuthInput {
  email: String!
  password: String!
}

"""
Input for new user registration.
Includes all required fields to create a user.
"""
input RegisterInput {
  email: String!
  password: String!
  name: String!
  role: String!
}

extend type Query {
  """
  Returns the current authenticated user. Requires a valid access token.
  """
  me: User @auth
}

extend type Mutation {
  """
  Register a new user and issue tokens.
  """
  register(input: RegisterInput!): AuthTokens!

  """
  Login an existing user and issue tokens, including the user's data.
  """
  login(input: AuthInput!): AuthTokens!

  """
  Exchange a valid refresh token for new tokens.
  """
  refreshToken(refreshToken: String!): AuthTokens!
}