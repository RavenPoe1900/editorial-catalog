"""
Tokens returned by authentication flows.
"""
type AuthTokens {
  accessToken: String!
  refreshToken: String!
}

"""
Input for authentication.
"""
input AuthInput {
  email: String!
  password: String!
}

extend type Query {
  """
  Returns the current authenticated user. Requires a valid access token.
  """
  me: User @auth
}

extend type Mutation {
  """
  Register a new user and issue tokens.
  """
  register(input: AuthInput!): AuthTokens!

  """
  Login an existing user and issue tokens.
  """
  login(input: AuthInput!): AuthTokens!

  """
  Exchange a valid refresh token for new tokens.
  """
  refreshToken(refreshToken: String!): AuthTokens!
}